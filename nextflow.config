manifest {
    name = 'bam_to_sam'
    description = 'Convert BAM files to SAM format using nf-core modules'
    version = '1.0.0'
    defaultBranch = 'main'
    mainScript = 'main.nf'
}

process {
    withLabel: process_low {
        cpus = 2
        memory = 4.GB
        time = 1.h
    }

    withName: 'SAMTOOLS_VIEW' {
        // interesting hard coded location...
        ext.args = '--output-fmt sam'

        publishDir = [
            path: { "${params.outdir}" },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
}

profiles {
    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'

    }

    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        process.container = 'https://depot.galaxyproject.org/singularity/samtools:1.17--hd87286a_1'
    }

    conda {
        conda.enabled = true
    }
}

// Argumentative!
params {
    input = "data/*.bam"
    outdir = "results"
}